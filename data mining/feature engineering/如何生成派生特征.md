# 如何生成派生特征

1. 如何利用单个特征生成派生特征?
2. 多个特征的联合如何生成派生特征?
3. 总结生成派生特征的一些原则
4. 一些和时间和位置相关的派生特征



## 手机型号与转化率

手机型号是一个常用的特征, 但是由于手机更新换代比较快, 每隔一段时间, 又会有新的手机上市, 曾经流行的手机, 会逐渐消失. 导致模型效果衰减很快.  同时, 手机型号多, 导致做one-hot后维度较大. 一个比较好的解决方案是直接利用目标函数对值做分类. 比如把那些高转化率的机型归入"高"类, 把那些低转化率机型归入"低"类, 其他机型归入"中"类. 决策树算法中, 常常这样干。 要这么干就需要计算各个机型对应的转化率， 那么"**手机型号对应的转化率**"就是一个派生特征。



这个派生特征用到了下文将会讲到的两个生成派生特征的技巧:

1. 用数值特征替换category value.
2. 用目标变量的历史值作为特征.

还能派生出的特征: 手机价格, 重量, 上市时间等.



## 单特征派生

### 正则化:

1. 中心化
2. 中心化后的值除以标准差



## 将数值转成百分位（标准化）

父母们谈论自己孩子身高，体重等身体参数时，直接说绝对值，比如“身高60cm”，不如说“身高处于同龄孩子身高的95分位”更能体现自己孩子的生理优势，因为孩子 比95%的同龄儿童都高。而且正则化基于正态假设，而转成分位数的方式与数值的分布无关。

 

## 将数值转成比率

数据库中往往有大量的数值：订单数，呼叫数目，在线时长等。而这些数值往往和用户的注册时长和生命周期等有关：一个已经注册6个月的用户的订单数和一个刚注册一个月用户的当担数的绝对值比较意义不大。往往是将订单数除以用户生命周期（在线时长）等得到的比率更有意义。 



## 类别特征（category feature）的数值化

最常见的处理办法是one hot representation,但one hot representation可能引起“维度爆炸”，大大增加模型的复杂度，当然，这可以用降维的方法来处理，不过如何降维不是本文的主题，后续会单独介绍。将category value数值化，要抓取类别特征的重要的数值特征，但什么样的数值特征是重要的呢？答案是和我们的目标关联性强的数值。在手机的转化率模型中，由手机型号派生出的重要的数值特征：手机的价格，重量，上市时间，受欢迎程度（销量），APP数量或者电池寿命等；而地理信息，或者国家可以派生出下列重要的数值特征：人口，人口密度，经纬度，海拔，收入中位数，年降雨量等。 



## 分箱

在某些场景，却需要根据数值特征生成类别特征，比如朴素bayes模型只支持类别特征（离散特征）。分桶，又叫离散化，就是把数值映射到一组区间，而用区间号代替数值。分箱的方法，大概分位下面三种:

1. 等距（等宽）分箱
2. 等频（等权重）分箱
3. 有监督分箱



